<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¬¸ì œ ì¹´ë“œ ìƒì„±ê¸°</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    h1 {
      margin-bottom: 20px;
    }
    .controls {
      background: white;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .controls input, .controls button, .controls select {
      margin: 5px;
      padding: 8px 12px;
      border-radius: 4px;
      border: 1px solid #ddd;
    }
    .controls button {
      background: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }
    .controls button:hover {
      background: #45a049;
    }
    .export-btn {
      background: #2196F3 !important;
    }
    .export-btn:hover {
      background: #0b7dda !important;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(var(--cols), 1fr);
      gap: 15px;
      margin-top: 20px;
    }
    .card {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 15px;
      text-align: center;
      background: #f1f9ff;
      font-size: 14px;
      min-height: 50px;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .card b {
      font-size: 18px;
      margin-bottom: 8px;
      display: block;
    }
    .card input {
      width: 90%;
      padding: 5px;
      margin: auto;
    }
    .delete-btn {
      margin-top: 8px;
      padding: 3px 6px;
      font-size: 12px;
      color: red;
      border: none;
      background: none;
      cursor: pointer;
    }
    .section-title {
      margin-top: 40px;
      margin-bottom: 10px;
      font-weight: bold;
      font-size: 18px;
      background: white;
      padding: 10px 20px;
      border-radius: 8px;
    }
    
    /* ìº¡ì²˜ë  ì˜ì—­ ìŠ¤íƒ€ì¼ - ê³ ì • ë„ˆë¹„ */
    #capture-area {
      background: white;
      padding: 30px;
      border-radius: 8px;
      margin-top: 20px;
      width: 1000px; /* ê³ ì • ë„ˆë¹„ */
      margin-left: auto;
      margin-right: auto;
      box-sizing: border-box;
    }
    .capture-title {
      font-size: 24px;
      font-weight: bold;
      text-align: center;
      margin-bottom: 20px;
      color: #333;
      padding-bottom: 15px;
      border-bottom: 2px solid #4CAF50;
    }
    .title-input-group {
      margin-bottom: 10px;
    }
    .title-input-group label {
      display: inline-block;
      width: 100px;
      font-weight: bold;
    }
    .title-input-group input {
      width: 300px;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <h1>ğŸ“ ë¬¸ì œ ì¹´ë“œ ìƒì„±ê¸°</h1>

  <!-- ì»¨íŠ¸ë¡¤ ì˜ì—­ -->
  <div class="controls">
    <div class="title-input-group">
      <label>ì œëª©:</label>
      <input type="text" id="title" value="í•™ìŠµ ë¬¸ì œ" placeholder="ì¹´ë“œ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" oninput="updateTitle()">
    </div>
    
    <div style="margin-top: 15px;">
      <label>ì´ ë¬¸ì œ ê°œìˆ˜:</label>
      <input type="number" id="count" value="10" min="1" style="width:80px">
      <button onclick="generateCards()">ë¹ˆ ì¹´ë“œ ìƒì„±</button>

      <label style="margin-left: 20px;">í•œ ì¤„ ê°œìˆ˜:</label>
      <select id="cols" onchange="updateGrid()">
        <option value="5">5</option>
        <option value="10">10</option>
      </select>

      <button class="export-btn" onclick="exportPNG()">ğŸ“¥ PNGë¡œ ë‚´ë³´ë‚´ê¸°</button>
    </div>

    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
      <button onclick="document.getElementById('fileInput').click()">ğŸ“ íŒŒì¼ì—ì„œ ê°€ì ¸ì˜¤ê¸° (txt)</button>
      <input type="file" id="fileInput" accept=".txt" style="display:none" onchange="loadFromFile(event)">
      
      <button onclick="toggleBulkInput()" style="margin-left: 10px;">âœï¸ ì¼ê´„ ì…ë ¥</button>
      <button onclick="clearAll()" style="margin-left: 10px; background: #f44336;">ğŸ—‘ï¸ ì „ì²´ ì§€ìš°ê¸°</button>
    </div>

    <!-- ì¼ê´„ ì…ë ¥ ì˜ì—­ -->
    <div id="bulk-input-area" style="display:none; margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee;">
      <div style="margin-bottom: 10px;">
        <strong>ğŸ’¡ í•œ ì¤„ì— í•˜ë‚˜ì”© ì…ë ¥í•˜ì„¸ìš”</strong> (ì˜ˆ: 1ë²ˆ ë¬¸ì œ, 2ë²ˆ ë¬¸ì œ, 3ë²ˆ ë¬¸ì œ...)
      </div>
      <textarea id="bulk-text" rows="10" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" placeholder="ë¬¸ì œ1&#10;ë¬¸ì œ2&#10;ë¬¸ì œ3&#10;..."></textarea>
      <div style="margin-top: 10px;">
        <button onclick="applyBulkInput()">âœ… ì ìš©í•˜ê¸°</button>
        <button onclick="toggleBulkInput()" style="background: #999;">ì·¨ì†Œ</button>
      </div>
    </div>
  </div>

  <!-- í¸ì§‘ ì˜ì—­ -->
  <div class="section-title">âœï¸ í¸ì§‘ ì˜ì—­</div>
  <div id="editor" class="grid" style="--cols:5"></div>

  <!-- ìº¡ì²˜ë  ì˜ì—­ -->
  <div class="section-title">ğŸ‘ï¸ ë¯¸ë¦¬ë³´ê¸° (ì œëª© í¬í•¨í•˜ì—¬ ì´ ì˜ì—­ì´ PNGë¡œ ì €ì¥ë©ë‹ˆë‹¤)</div>
  <div id="capture-area">
    <div class="capture-title" id="preview-title">í•™ìŠµ ë¬¸ì œ</div>
    <div id="preview" class="grid" style="--cols:5"></div>
  </div>

  <!-- html2canvas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    let items = [];

    // ì¹´ë“œ ì¼ê´„ ìƒì„±
    function generateCards() {
      const count = parseInt(document.getElementById("count").value);
      items = new Array(count).fill("");
      renderEditor();
      renderPreview();
    }

    // í¸ì§‘ ì˜ì—­ ë Œë”ë§
    function renderEditor() {
      const editor = document.getElementById("editor");
      editor.innerHTML = "";
      items.forEach((text, idx) => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `
          <b>${idx+1}</b>
          <input type="text" value="${text}" 
            oninput="updateText(${idx}, this.value)" placeholder="ë¬¸ì œ í…ìŠ¤íŠ¸ ì…ë ¥">
          <button class="delete-btn" onclick="deleteCard(${idx})">ì‚­ì œ</button>
        `;
        editor.appendChild(div);
      });
    }

    // ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ ë Œë”ë§
    function renderPreview() {
      const preview = document.getElementById("preview");
      preview.innerHTML = "";
      items.forEach((text, idx) => {
        const div = document.createElement("div");
        div.className = "card";
        div.innerHTML = `<b>${idx+1}</b><div>${text}</div>`;
        preview.appendChild(div);
      });
    }

    // í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
    function updateText(index, value) {
      items[index] = value;
      renderPreview();
    }

    // ì œëª© ì—…ë°ì´íŠ¸
    function updateTitle() {
      const title = document.getElementById("title").value;
      document.getElementById("preview-title").textContent = title || "í•™ìŠµ ë¬¸ì œ";
    }

    // ê°œë³„ ì¹´ë“œ ì‚­ì œ
    function deleteCard(index) {
      items.splice(index, 1);
      renderEditor();
      renderPreview();
    }

    // ê·¸ë¦¬ë“œ ì—´ ê°œìˆ˜ ì—…ë°ì´íŠ¸
    function updateGrid() {
      const cols = document.getElementById("cols").value;
      document.getElementById("editor").style.setProperty("--cols", cols);
      document.getElementById("preview").style.setProperty("--cols", cols);
    }

    // PNG ë‚´ë³´ë‚´ê¸° (ê°œì„ ëœ ë²„ì „)
    function exportPNG() {
      const captureArea = document.getElementById("capture-area");
      const title = document.getElementById("title").value || "í•™ìŠµë¬¸ì œ";
      
      // ìº¡ì²˜ ì˜µì…˜ ì„¤ì •
      const options = {
        backgroundColor: '#ffffff',
        scale: 2, // ê³ í•´ìƒë„
        logging: false,
        useCORS: true,
        allowTaint: true,
        scrollY: -window.scrollY,
        scrollX: -window.scrollX,
        windowWidth: document.documentElement.scrollWidth,
        windowHeight: document.documentElement.scrollHeight
      };
      
      html2canvas(captureArea, options).then(canvas => {
        const link = document.createElement("a");
        const filename = `${title}_${new Date().toISOString().slice(0,10)}.png`;
        link.download = filename;
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    }

    // ì´ˆê¸° ë¡œë“œ ì‹œ ì¹´ë“œ ìƒì„±
    window.onload = function() {
      generateCards();
    };

    // ì¼ê´„ ì…ë ¥ ì˜ì—­ í† ê¸€
    function toggleBulkInput() {
      const bulkArea = document.getElementById("bulk-input-area");
      if (bulkArea.style.display === "none") {
        bulkArea.style.display = "block";
        // í˜„ì¬ ë‚´ìš©ì„ í…ìŠ¤íŠ¸ë¡œ í‘œì‹œ
        document.getElementById("bulk-text").value = items.join("\n");
      } else {
        bulkArea.style.display = "none";
      }
    }

    // ì¼ê´„ ì…ë ¥ ì ìš©
    function applyBulkInput() {
      const text = document.getElementById("bulk-text").value;
      const lines = text.split("\n"); // ë¹ˆ ì¤„ë„ ìœ ì§€
      items = lines;
      renderEditor();
      renderPreview();
      toggleBulkInput();
    }

    // íŒŒì¼ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
    function loadFromFile(event) {
      const file = event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = function(e) {
        const text = e.target.result;
        const lines = text.split("\n"); // ë¹ˆ ì¤„ë„ ìœ ì§€
        items = lines;
        renderEditor();
        renderPreview();
        alert(`${lines.length}ê°œì˜ ì¹´ë“œë¥¼ ë¶ˆëŸ¬ì™”ìŠµë‹ˆë‹¤!`);
      };
      reader.readAsText(file, "UTF-8");
      
      // íŒŒì¼ ì…ë ¥ ì´ˆê¸°í™” (ê°™ì€ íŒŒì¼ ì¬ì„ íƒ ê°€ëŠ¥í•˜ë„ë¡)
      event.target.value = "";
    }

    // ì „ì²´ ì§€ìš°ê¸°
    function clearAll() {
      if (confirm("ëª¨ë“  ì¹´ë“œë¥¼ ì§€ìš°ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        items = [];
        renderEditor();
        renderPreview();
      }
    }
  </script>
</body>
</html>
